/* leitor.css - Estilos do Plugin de Leitura Bíblica (iPhone-first) */

/* === Container do Plugin === */
.leitor-plugin {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* === Botão Principal === */
.leitor-btn {
  background: none;
  border: none;
  padding: 8px;
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  
  /* Otimizações para iPhone */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  -webkit-touch-callout: none;
  user-select: none;
  
  /* Tamanho adequado para toque */
  min-width: 32px;
  min-height: 32px;
}

/* === Ícone do Livro === */
.leitor-icon {
  width: 20px;
  height: 20px;
  stroke: #333;
  stroke-width: 2;
  fill: none;
  transition: all 0.2s ease;
}

/* === Estados do Botão === */

/* Hover (para desktop/cursor) */
.leitor-btn:hover {
  background-color: #f0f0f0;
}

/* Ativo (modo leitura ativado) */
.leitor-btn.active {
  background-color: #007AFF;
  color: white;
}

.leitor-btn.active .leitor-icon {
  stroke: white;
  fill: white;
}

/* Pressionado (feedback visual) */
.leitor-btn:active {
  background-color: #e0e0e0;
  transform: scale(0.95);
}

.leitor-btn.active:active {
  background-color: #0056b3;
}

/* === Estados do Editor === */

/* Modo Leitura Ativo - MELHORADO */
.editor-content.reading-mode {
  background-color: #fefefe;
  border: 2px solid #007AFF;
  border-radius: 8px;
  padding: 16px;
  
  /* Cursor indica que não é editável */
  cursor: default;
  
  /* NOVO: Remove completamente cursor/caret e seleção apenas no modo leitura */
  caret-color: transparent !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  
  /* NOVO: Previne teclado virtual */
  -webkit-touch-callout: none !important;
  -webkit-tap-highlight-color: transparent !important;
  
  /* Sombra suave para destacar o modo */
  box-shadow: 0 2px 8px rgba(0, 122, 255, 0.1);
}

/* NOVO: Bloqueia qualquer interação de texto no modo leitura */
.editor-content.reading-mode * {
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  caret-color: transparent !important;
}

/* NOVO: Remove outline/focus de qualquer elemento no modo leitura */
.editor-content.reading-mode *:focus {
  outline: none !important;
  border: none !important;
  box-shadow: none !important;
}

/* CORRIGIDO: Garante que fora do modo leitura tudo funciona normalmente */
.editor-content:not(.reading-mode) {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

.editor-content:not(.reading-mode) * {
  -webkit-user-select: inherit;
  -moz-user-select: inherit;
  -ms-user-select: inherit;
  user-select: inherit;
}

/* === Estilos para Referências Bíblicas === */

/* Links bíblicos no modo leitura */
.reading-mode a.bbl {
  color: #0056b3;
  text-decoration: none; /* REMOVIDO: sublinhado */
  font-weight: 500;
  border-radius: 2px;
  transition: all 0.3s ease;
  cursor: pointer;
  
  /* CORRIGIDO: Remove QUALQUER espaçamento/padding */
  padding: 0;
  margin: 0;
  border: none;
  display: inline;
  line-height: inherit;
  vertical-align: baseline;
  
  /* Otimizações para toque */
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  user-select: none;
}

/* === Animações de Interação (Long Press) === */

/* Estado pressionando */
.reading-mode a.bbl.bbl-pressing {
  background-color: rgba(0, 86, 179, 0.1);
  transform: scale(1.02);
  text-decoration-color: #0056b3;
}

/* Estado abrindo */
.reading-mode a.bbl.bbl-opening {
  background-color: rgba(0, 86, 179, 0.2);
  transform: scale(1.05);
  color: #003d82;
}

/* === Indicador Visual de Modo Ativo === */

/* Badge/indicador no slot quando ativo */
.plugin-slot[data-slot="6"] .leitor-btn.active::after {
  content: '';
  position: absolute;
  top: 2px;
  right: 2px;
  width: 6px;
  height: 6px;
  background-color: #34C759;
  border-radius: 50%;
  border: 1px solid white;
}

/* === Responsividade === */

/* Para telas menores (iPhone SE, etc.) */
@media (max-width: 375px) {
  .leitor-btn {
    padding: 6px;
    min-width: 28px;
    min-height: 28px;
  }
  
  .leitor-icon {
    width: 18px;
    height: 18px;
  }
}

/* Para telas maiores (iPhone Pro Max, iPad) */
@media (min-width: 768px) {
  .leitor-btn {
    padding: 10px;
    min-width: 36px;
    min-height: 36px;
  }
  
  .leitor-icon {
    width: 22px;
    height: 22px;
  }
}

/* === Acessibilidade === */

/* Foco para navegação por teclado */
.leitor-btn:focus {
  outline: 2px solid #007AFF;
  outline-offset: 2px;
}

/* Redução de movimento para quem prefere */
@media (prefers-reduced-motion: reduce) {
  .leitor-btn,
  .leitor-icon,
  .reading-mode a.bbl {
    transition: none;
  }
  
  .reading-mode a.bbl.bbl-pressing,
  .reading-mode a.bbl.bbl-opening {
    transform: none;
  }
}

/* === PROTEÇÃO CONTRA SELEÇÃO DE TEXTO (como stylebbl.css original) === */
/* CORRIGIDO: Aplica apenas quando necessário, não globalmente */
.reading-mode .no-select-global,
.reading-mode .no-select-global * {
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -khtml-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-tap-highlight-color: transparent !important;
}

.reading-mode .no-select-global *::selection {
  background: transparent !important;
}

.reading-mode .no-select-global *::-moz-selection {
  background: transparent !important;
}

/* CORRIGIDO: Escopo apenas para modal bíblico */
#modal-biblia,
#modal-biblia * {
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
}

/* === Dark Mode (se implementado futuramente) === */
@media (prefers-color-scheme: dark) {
  .leitor-btn:hover {
    background-color: #2c2c2e;
  }
  
  .leitor-icon {
    stroke: #ffffff;
  }
  
  .editor-content.reading-mode {
    background-color: #1c1c1e;
    border-color: #0984ff;
    color: #ffffff;
  }
  
  .reading-mode a.bbl {
    color: #0056b3;
    text-decoration: none; /* MANTÉM: sem sublinhado no dark mode */
  }
}